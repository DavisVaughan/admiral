<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Derive Last Known Alive Date — derive_var_lstalvdt • admiral</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Derive Last Known Alive Date — derive_var_lstalvdt" />
<meta property="og:description" content="Add the last known alive date (LSTALVDT) to the dataset." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admiral</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/admiral.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">User Guides</li>
    <li>
      <a href="../articles/adsl.html">Creating ADSL</a>
    </li>
    <li>
      <a href="../articles/occds.html">Creating an OCCDS ADaM</a>
    </li>
    <li>
      <a href="../articles/bds_finding.html">Creating a BDS Finding ADaM</a>
    </li>
    <li>
      <a href="../articles/bds_exposure.html">Creating a BDS Exposure ADaM</a>
    </li>
    <li>
      <a href="../articles/bds_tte.html">Creating a BDS Time-to-Event ADaM</a>
    </li>
    <li>
      <a href="../articles/imputation.html">Date and Time Imputation</a>
    </li>
    <li>
      <a href="../articles/queries_dataset.html">Queries Dataset Documentation</a>
    </li>
    <li>
      <a href="../articles/faq.html">FAQ</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Developer Guides</li>
    <li>
      <a href="../articles/contribution_model.html">Contribution to admiral</a>
    </li>
    <li>
      <a href="../articles/programming_strategy.html">Programming Strategy</a>
    </li>
    <li>
      <a href="../articles/git_usage.html">Guidance for git Usage</a>
    </li>
    <li>
      <a href="../articles/writing_vignettes.html">Writing Vignettes</a>
    </li>
    <li>
      <a href="../articles/pr_review_guidance.html">Pull Request Review Guidance</a>
    </li>
    <li>
      <a href="../articles/unit_test_guidance.html">Unit Test Guidance</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Roche-GSK/admiral/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Derive Last Known Alive Date</h1>
    <small class="dont-index">Source: <a href='https://github.com/Roche-GSK/admiral/blob/master/R/derive_var_lstalvdt.R'><code>R/derive_var_lstalvdt.R</code></a></small>
    <div class="hidden name"><code>derive_var_lstalvdt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add the last known alive date (<code>LSTALVDT</code>) to the dataset.</p>
    </div>

    <pre class="usage"><span class='fu'>derive_var_lstalvdt</span>(<span class='no'>dataset</span>, <span class='no'>...</span>, <span class='kw'>subject_keys</span> <span class='kw'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span>(<span class='no'>STUDYID</span>, <span class='no'>USUBJID</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataset</th>
      <td><p>Input dataset</p>
<p>The <code>USUBJID</code> variable is expected.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Source of known alive dates. A <code><a href='lstalvdt_source.html'>lstalvdt_source()</a></code> object is
expected.</p></td>
    </tr>
    <tr>
      <th>subject_keys</th>
      <td><p>Variables to uniquely identify a subject</p>
<p>A list of quosures where the expressions are symbols as returned by
<code><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars()</a></code> is expected.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The input dataset with the <code>LSTALVDT</code> variable added.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The following steps are performed to create the output dataset:</p>
<ol>
<li><p>For each source dataset the observations as specified by
the <code>filter</code> element are selected. Then for each patient the last
observation (with respect to <code>date</code>) is selected.</p></li>
<li><p>The <code>LSTALVDT</code> variable is set to the variable specified by the
<code>date</code> element. If the date variable is a datetime variable, only
the datepart is copied. If the source variable is a character variable, it
is converted to a date. If the date is incomplete, it is imputed as
specified by the <code>date_imputation</code> element.</p></li>
<li><p>The variables specified by the <code>traceability_vars</code> element are
added.</p></li>
<li><p>The selected observations of all source datasets are combined into a
single dataset.</p></li>
<li><p>For each patient the last observation (with respect to the <code>LSTALVDT</code>
variable) from the single dataset is selected and the new variable is
merged to the input dataset.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>, <span class='kw'>warn.conflicts</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>admiral.test</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"dm"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"ae"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"lb"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"adsl"</span>)

<span class='no'>ae_start</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lstalvdt_source.html'>lstalvdt_source</a></span>(
  <span class='kw'>dataset</span> <span class='kw'>=</span> <span class='no'>ae</span>,
  <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>AESTDTC</span>,
  <span class='kw'>date_imputation</span> <span class='kw'>=</span> <span class='st'>"first"</span>
)
<span class='no'>ae_end</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lstalvdt_source.html'>lstalvdt_source</a></span>(
  <span class='kw'>dataset</span> <span class='kw'>=</span> <span class='no'>ae</span>,
  <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>AEENDTC</span>,
  <span class='kw'>date_imputation</span> <span class='kw'>=</span> <span class='st'>"first"</span>
)
<span class='no'>lb_date</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lstalvdt_source.html'>lstalvdt_source</a></span>(
  <span class='kw'>dataset</span> <span class='kw'>=</span> <span class='no'>lb</span>,
  <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>LBDTC</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nchar.html'>nchar</a></span>(<span class='no'>LBDTC</span>) <span class='kw'>&gt;=</span> <span class='fl'>10</span>
)
<span class='no'>adsl_date</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lstalvdt_source.html'>lstalvdt_source</a></span>(<span class='kw'>dataset</span> <span class='kw'>=</span> <span class='no'>adsl</span>, <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>TRTEDT</span>)

<span class='no'>dm</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>derive_var_lstalvdt</span>(<span class='no'>ae_start</span>, <span class='no'>ae_end</span>, <span class='no'>lb_date</span>, <span class='no'>adsl_date</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span>(<span class='no'>USUBJID</span>, <span class='no'>LSTALVDT</span>)</div><div class='output co'>#&gt; # A tibble: 306 x 2
#&gt;    USUBJID     LSTALVDT  
#&gt;    &lt;chr&gt;       &lt;date&gt;    
#&gt;  1 01-701-1015 2014-07-02
#&gt;  2 01-701-1023 2012-09-02
#&gt;  3 01-701-1028 2014-01-14
#&gt;  4 01-701-1033 2014-04-14
#&gt;  5 01-701-1034 2014-12-30
#&gt;  6 01-701-1047 2013-04-07
#&gt;  7 01-701-1057 NA        
#&gt;  8 01-701-1097 2014-07-09
#&gt;  9 01-701-1111 2012-09-17
#&gt; 10 01-701-1115 2013-01-23
#&gt; # … with 296 more rows</div><div class='input'>
<span class='co'># derive last alive date and traceability variables</span>
<span class='no'>ae_start</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lstalvdt_source.html'>lstalvdt_source</a></span>(
  <span class='kw'>dataset</span> <span class='kw'>=</span> <span class='no'>ae</span>,
  <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>AESTDTC</span>,
  <span class='kw'>date_imputation</span> <span class='kw'>=</span> <span class='st'>"first"</span>,
  <span class='kw'>traceability_vars</span> <span class='kw'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span>(
    <span class='kw'>LALVDOM</span> <span class='kw'>=</span> <span class='st'>"AE"</span>,
    <span class='kw'>LALVSEQ</span> <span class='kw'>=</span> <span class='no'>AESEQ</span>,
    <span class='kw'>LALVVAR</span> <span class='kw'>=</span> <span class='st'>"AESTDTC"</span>
  )
)

<span class='no'>ae_end</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lstalvdt_source.html'>lstalvdt_source</a></span>(
  <span class='kw'>dataset</span> <span class='kw'>=</span> <span class='no'>ae</span>,
  <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>AEENDTC</span>,
  <span class='kw'>date_imputation</span> <span class='kw'>=</span> <span class='st'>"first"</span>,
  <span class='kw'>traceability_vars</span> <span class='kw'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span>(
    <span class='kw'>LALVDOM</span> <span class='kw'>=</span> <span class='st'>"AE"</span>,
    <span class='kw'>LALVSEQ</span> <span class='kw'>=</span> <span class='no'>AESEQ</span>,
    <span class='kw'>LALVVAR</span> <span class='kw'>=</span> <span class='st'>"AEENDTC"</span>
  )
)
<span class='no'>lb_date</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lstalvdt_source.html'>lstalvdt_source</a></span>(
  <span class='kw'>dataset</span> <span class='kw'>=</span> <span class='no'>lb</span>,
  <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>LBDTC</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nchar.html'>nchar</a></span>(<span class='no'>LBDTC</span>) <span class='kw'>&gt;=</span> <span class='fl'>10</span>,
  <span class='kw'>traceability_vars</span> <span class='kw'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span>(
    <span class='kw'>LALVDOM</span> <span class='kw'>=</span> <span class='st'>"LB"</span>,
    <span class='kw'>LALVSEQ</span> <span class='kw'>=</span> <span class='no'>LBSEQ</span>,
    <span class='kw'>LALVVAR</span> <span class='kw'>=</span> <span class='st'>"LBDTC"</span>
  )
)

<span class='no'>adsl_date</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lstalvdt_source.html'>lstalvdt_source</a></span>(
  <span class='kw'>dataset</span> <span class='kw'>=</span> <span class='no'>adsl</span>,
  <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>TRTEDT</span>,
  <span class='kw'>traceability_vars</span> <span class='kw'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span>(
    <span class='kw'>LALVDOM</span> <span class='kw'>=</span> <span class='st'>"ADSL"</span>,
    <span class='kw'>LALVSEQ</span> <span class='kw'>=</span> <span class='fl'>NA_integer_</span>,
    <span class='kw'>LALVVAR</span> <span class='kw'>=</span> <span class='st'>"TRTEDTM"</span>
  )
)

<span class='no'>dm</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>derive_var_lstalvdt</span>(<span class='no'>ae_start</span>, <span class='no'>ae_end</span>, <span class='no'>lb_date</span>, <span class='no'>adsl_date</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span>(<span class='no'>USUBJID</span>, <span class='no'>LSTALVDT</span>, <span class='no'>LALVDOM</span>, <span class='no'>LALVSEQ</span>, <span class='no'>LALVVAR</span>)</div><div class='output co'>#&gt; # A tibble: 306 x 5
#&gt;    USUBJID     LSTALVDT   LALVDOM LALVSEQ LALVVAR
#&gt;    &lt;chr&gt;       &lt;date&gt;     &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;  
#&gt;  1 01-701-1015 2014-07-02 ADSL         NA TRTEDTM
#&gt;  2 01-701-1023 2012-09-02 LB          107 LBDTC  
#&gt;  3 01-701-1028 2014-01-14 ADSL         NA TRTEDTM
#&gt;  4 01-701-1033 2014-04-14 LB          107 LBDTC  
#&gt;  5 01-701-1034 2014-12-30 ADSL         NA TRTEDTM
#&gt;  6 01-701-1047 2013-04-07 LB          134 LBDTC  
#&gt;  7 01-701-1057 NA         &lt;NA&gt;         NA &lt;NA&gt;   
#&gt;  8 01-701-1097 2014-07-09 ADSL         NA TRTEDTM
#&gt;  9 01-701-1111 2012-09-17 LB           73 LBDTC  
#&gt; 10 01-701-1115 2013-01-23 ADSL         NA TRTEDTM
#&gt; # … with 296 more rows</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Thomas Neitmann, Alice Ehmann, Stefan Bundfuss, Samia Kabi, Vignesh Thanikachalam, Ondrej Slama, Shimeng Huang, Robin Koeger, Gordon Miller, Teckla Akinyi, Eric Simms, Michael Thorpe, Pavan Kumar, Hamza Rahal, F. Hoffmann-La Roche AG, GlaxoSmithKline LLC.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '2d4895759f79e89d6eb1c3b990bca6d8',
    indexName: 'roche-gsk',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


